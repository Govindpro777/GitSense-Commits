# Activity Summary for 12/19/2025

## 12:49:31 AM
The changes log primarily consists of updates to two React components responsible for file management: `FileManager.jsx` in `all_notices` and `case_status` directories.

**File-specific updates:**

1.  **`c:\Users\91965\Desktop\MikeLegal\CaseTrack-frontend\apps\casetrack-web\src\components\all_notices\FileManager.jsx`**
    *   **Timestamp:** `12/18/2025, 8:41:01 PM`
    *   This initial entry shows a comprehensive `FileManager` component for "notice documents." Key functionalities include:
        *   Fetching existing files (`fetchData`) related to a `notice_id`.
        *   Uploading files to S3 via signed URLs (`getSignedUrl`, `uploadFile`), including progress tracking and cancellation (`AbortController`).
        *   Handling file input changes (`handleFileChange`) to initiate uploads and manage `uploadStatus`.
        *   Displaying an `UploadProgressBar` for ongoing uploads.
        *   Downloading all files (`onDownloadAll`) related to a notice.
        *   Error handling with `axios.isAxiosError` and `Sentry` integration.
        *   UI elements for "Download All" and "Upload Files" buttons, with disabled states based on online status and permissions (`isAllowed`).
        *   The `useEffect` hook for `fetchData` has a dependency on `[reload]`, suggesting an external mechanism to trigger data refetching.

2.  **`c:\Users\91965\Desktop\MikeLegal\CaseTrack-frontend\apps\casetrack-web\src\components\case_status\FileManager.jsx`**
    *   **Timestamps:** Multiple changes occurred between `12/18/2025, 8:41:23 PM` and `12/18/2025, 11:28:13 PM`.
    *   **Recurring Pattern:** This file saw numerous identical or near-identical changes over a short period.
    *   **Initial state (`12/18/2025, 8:41:23 PM`)**: This component is largely a duplicate of the `all_notices` version, but adapted for "case documents."
        *   The `fetchData` and `getSignedUrl` operations specifically target `document_for=CASE_DOCUMENT` and use `management_case_id` instead of `notice_id`.
        *   The `useEffect` hook for `fetchData` has an empty dependency array `[]`, meaning it runs only once on component mount.
        *   The `handleAxiosError` function is imported from `../functions` instead of being defined internally, and `Sentry` is not imported or used here.
    *   **Subsequent changes (`12/18/2025, 8:41:33 PM`, `8:43:39 PM`, `8:43:53 PM`, `8:44:19 PM`):** These timestamps show no functional changes in the provided code snippets. The content appears identical across these revisions, suggesting minor edits, re-saves, or potentially an IDE's auto-save behavior without significant code alteration. A notable UI change at `8:43:39 PM` is the header text changing from `<div>File Manage</div>` to `<div>File Manager</div>`.
    *   **Further changes (`12/18/2025, 8:44:25 PM`, `9:30:24 PM`):**
        *   At `8:44:19 PM`, an additional "Upload Files" button appeared in the UI, nearly identical to the existing one, but with the text `Upload Fi`. This was likely a partial or erroneous addition.
        *   At `8:44:25 PM`, the second "Upload Fi" button was changed to `Upload`. This continued to be an erroneous duplicate button.
        *   At `9:30:24 PM`, the second upload button's text was corrected to "Upload Directory". This indicates an intent to introduce functionality for uploading directories, although the `input type="file"` element still only supports file selection (`multiple` attribute) and not directory selection (`webkitdirectory` attribute, which is not present). Functionally, both buttons still trigger the same `handleFileChange` which processes individual files.
    *   **Mass commenting out (`12/18/2025, 10:40:29 PM`, `10:50:26 PM`, `11:15:27 PM`, `11:18:26 PM`, `11:22:15 PM`):** The component was almost entirely commented out in multiple consecutive commits. This highly suggests a developer temporarily disabling the component for debugging, testing, or a major refactor. The timestamps indicate this was a sustained effort over roughly an hour.
    *   **Uncommenting (`12/18/2025, 11:22:56 PM`):** The component was fully restored, undoing all the commenting out.
    *   **Final state (`12/18/2025, 11:25:18 PM`, `11:28:13 PM`):** The component remains uncommented, and the changes are identical again, indicating minor saves without functional modifications.

**Patterns and Recurring Elements:**

*   **Duplication and Adaptation:** The `FileManager.jsx` component exists in two different directory structures (`all_notices` and `case_status`), indicating a pattern of code reuse. The core logic for file fetching, S3 signed URL generation, upload with progress, and error handling is identical. The primary difference is the `document_for` and corresponding `id` parameter (`notice_id` vs. `management_case_id`) used in API calls.
*   **Timestamp proximity:** Several log entries for `case_status\FileManager.jsx` are very close in time (e.g., within seconds or minutes), especially during the initial additions and later during the commenting/uncommenting phases. This suggests rapid development, frequent saving, or automated processes.
*   **Upload/Download Functionality:** Both components consistently implement functionality for uploading multiple files, tracking upload progress, and downloading all associated files.
*   **Error Handling and User Feedback:** Both utilize `axios` for API calls, `message` from `antd` for user feedback (success/error), and have a `handleAxiosError` function. The `all_notices` version additionally integrates with `Sentry` for error tracking.
*   **Online Status Check:** Both use a `useOnlineStatus` hook to disable buttons when offline, improving user experience.
*   **AbortController for Uploads:** Both components use `AbortController` to manage and cancel in-progress file uploads, storing controllers in `controllersRef.current`.
*   **Temporary Commenting:** The `case_status` version shows a distinct pattern of having its entire code commented out and then uncommented, indicating a significant temporary modification or testing phase.
*   **Minor UI/Text Tweaks:** Small changes like "File Manage" to "File Manager" in the UI header, and the evolution of the second "Upload" button's text (`Upload Fi` -> `Upload` -> `Upload Directory`), suggest iterative UI refinement.

## 10:33:54 AM
The provided log details changes primarily to two files: `FileManager.jsx` located in `c:\Users\91965\Desktop\MikeLegal\CaseTrack-frontend\apps\casetrack-web\src\components\all_notices\` and `FileManager.jsx` located in `c:\Users\91965\Desktop\MikeLegal\CaseTrack-frontend\apps\casetrack-web\src\components\case_status\`.

### File-Specific Updates:

1.  **`c:\Users\91965\Desktop\MikeLegal\CaseTrack-frontend\apps\casetrack-web\src\components\all_notices\FileManager.jsx`**
    *   **Timestamp:** 12/18/2025, 8:41:01 PM
    *   **Key Changes:** This file, a React component named `FileManager`, handles file management for "notice documents." It features functionalities for fetching, uploading (to S3 via signed URLs), and downloading files. It uses `axios` for API calls, `react-router-dom` for search parameters, `antd` for UI elements (like `message` and `Button` from the other FileManager), `react-redux` for user data, and `Sentry` for error tracking. It includes a `FileManagerGrid` for displaying files and `UploadProgressBar` for visualizing upload status. Notable features include `AbortController` for cancelling uploads, a `useOnlineStatus` hook, and tracking button clicks via `trackWeb`. The `fetchData` function is triggered on `reload` prop change, indicating potential external refresh. This component specifically targets `NOTICE_DOCUMENT` for file operations.

2.  **`c:\Users\91965\Desktop\MikeLegal\CaseTrack-frontend\apps\casetrack-web\src\components\case_status\FileManager.jsx`**
    *   **Initial Changes (12/18/2025, 8:41:23 PM - 8:44:19 PM):** This file is very similar in structure and functionality to the `all_notices` counterpart. It also manages file operations (fetch, upload, download) using `axios`, `react-router-dom`, `antd`, `react-redux`, and `useOnlineStatus`. It also uses `AbortController` for uploads and tracks button clicks. The key difference is that this component specifically targets `CASE_DOCUMENT` and `management_case_id` for file operations and API calls. There are multiple identical commits within this short timeframe, indicating minor saves or formatting changes that didn't alter the core logic.
    *   **Minor UI Adjustment (12/18/2025, 8:43:39 PM):** The `File Manager` header text inside the JSX was briefly changed to `File Manage`, then reverted back to `File Manager` almost immediately in the next commit. This suggests a minor UI text correction.
    *   **Addition of a Second Upload Button (12/18/2025, 8:44:19 PM - 8:44:25 PM):** A duplicate "Upload Files" button was added to the UI, with slightly different text variations ("Upload Fi" and "Upload"). This appears to be an accidental addition or a work-in-progress UI change, as the button had identical functionality to the first "Upload Files" button, except for its label.
    *   **Label Correction (12/18/2025, 9:30:24 PM):** The second upload button's label was changed to "Upload Directory," suggesting an intention to implement directory upload functionality.
    *   **Comment Out (12/18/2025, 10:40:29 PM - 11:18:26 PM):** A significant portion of the entire `FileManager` component was commented out in several consecutive commits. This essentially disabled almost all its functionality, rendering it mostly inert. This massive commenting out suggests a temporary disabling of the component, perhaps for refactoring, debugging, or to switch to a different implementation approach.
    *   **Uncomment (12/18/2025, 11:22:56 PM):** The entire component that was previously commented out was restored (uncommented), bringing back all its functionalities. This indicates the component was reactivated after the temporary disabling phase.

### Timestamps of Significant Changes:

*   **12/18/2025, 8:41:01 PM:** Initial version of `FileManager.jsx` for `all_notices` (notice documents).
*   **12/18/2025, 8:41:23 PM:** Initial version of `FileManager.jsx` for `case_status` (case documents).
*   **12/18/2025, 8:43:39 PM:** Brief UI text change (`File Manage` to `File Manager`).
*   **12/18/2025, 8:44:19 PM - 8:44:25 PM:** Accidental duplication/temporary addition of an upload button with differing text.
*   **12/18/2025, 9:30:24 PM:** Introduction of "Upload Directory" button in `case_status\FileManager.jsx`.
*   **12/18/2025, 10:40:29 PM - 11:18:26 PM:** Extensive commenting out of `case_status\FileManager.jsx` component.
*   **12/18/2025, 11:22:56 PM:** Full uncommenting and restoration of `case_status\FileManager.jsx`.

### Patterns and Recurring Elements:

*   **Code Duplication:** The `FileManager.jsx` component in `all_notices` and `case_status` directories are almost identical, differing only in the `document_for` parameter (either `NOTICE_DOCUMENT` or `CASE_DOCUMENT`) and `id` parameter name (`notice_id` vs. `management_case_id`) used in API calls. This suggests a pattern of creating highly similar, context-specific components instead of a single reusable component with configurable parameters.
*   **File Upload/Download Logic:** Both files implement a robust file upload mechanism involving fetching signed S3 URLs, uploading directly to S3 with progress tracking, and then notifying the backend. They also feature a "Download All" functionality for streaming files.
*   **Error Handling:** Both components use a `handleAxiosError` function (though in `case_status` it's imported from `../functions`, while in `all_notices` it's defined locally) for consistent Axios error management, including Sentry integration in the `all_notices` version.
*   **State Management:** Both utilize `useState` extensively for managing UI state (e.g., `filesData`, `loaderType`, `uploadStatus`, `isUploadModalVisible`) and `useRef` for DOM references and `AbortController` instances.
*   **User Interaction Tracking:** Both components integrate `trackWeb(EVENTS.BUTTON_CLICKED, { buttonName: ... })` to log user interactions, specifically button clicks for uploading files.
*   **Online Status Check:** Both use a `useOnlineStatus` custom hook to disable upload/download functionality when offline.
*   **Upload Progress Modal:** Both use an `UploadProgressBar` component, indicating a standardized UI for showing upload status.
*   **Temporary Commenting:** The `case_status\FileManager.jsx` saw a pattern of being entirely commented out and then uncommented, suggesting active development, refactoring, or troubleshooting cycles for that specific component.
*   **Future Feature Indication:** The "Upload Directory" button added to `case_status\FileManager.jsx` suggests an upcoming feature for uploading entire folders.

## 1:36:54 PM
The log details changes across two primary files: `package.json` and `app/layout.tsx`, all occurring on December 19, 2025, within approximately an hour.

**File-specific Updates:**

*   **`c:\Users\91965\Desktop\MikeLegal\MikeLegal-Web\package.json`**:
    *   At **11:40:11 AM**, `package.json` included `check-node-version` and `preinstall` scripts.
    *   By **11:43:06 AM**, these node version-related scripts were removed.
    *   A significant update at **12:02:29 PM** saw the reintroduction of the `check-node-version` and `preinstall` scripts, along with the addition of an `engines` field specifying Node.js version `18.17.1` and npm `9.6.7`.
    *   Dependencies remained consistent, including various React, Next.js, and utility libraries like `@hookform/resolvers`, `antd`, `axios`, `motion`, `sharp`, `simple-git`, `typescript`, and `zod`.

*   **`c:\Users\91965\Desktop\MikeLegal\MikeLegal-Web\app\layout.tsx`**:
    *   The initial state at **11:52:04 AM** defined the main `RootLayout` for the Next.js application, importing `Navbar`, `Footer`, `Loader`, `GoogleAnalytics`, and `CookieBanner`. A client-side script for fading out a page loader was present in the `<head>`. `Navbar`, `Footer`, `Loader`, `GoogleAnalytics`, and `CookieBanner` were all commented out in the `<body>`.
    *   Between **11:52:22 AM** and **11:57:08 AM**, there was a series of toggles where `Navbar` was repeatedly uncommented and then commented out again in the `<body>`, while `Footer` was uncommented then commented out, and finally uncommented again. This suggests active testing or decision-making regarding these components' inclusion.
    *   By **11:59:09 AM**, both `Navbar` and `Footer` imports were removed, and their corresponding JSX elements in the `<body>` were commented out or removed, leaving only `children` and other previously commented components (`Loader`, `GoogleAnalytics`, `CookieBanner`) in the main layout.
    *   The entry at **12:11:55 PM** shows no further changes, retaining the layout from the previous timestamp.
    *   The file consistently defines metadata (title, description, favicon), imports `localFont` for custom SF Pro Display fonts, and includes a JavaScript snippet for a page loader fade-out animation.

**Patterns and Recurring Elements:**

*   **Version Control Scripting**: There's a back-and-forth pattern in `package.json` regarding the `check-node-version` and `preinstall` scripts, eventually settling on their inclusion and explicit engine version requirements.
*   **Component Toggling**: In `app/layout.tsx`, the repeated commenting and uncommenting of `Navbar` and `Footer` components indicates an iterative development or debugging process for integrating or excluding these structural components from the main application layout. Ultimately, these components were removed from the layout.
*   **Consistent Core Dependencies**: The project maintains a stable set of dependencies related to Next.js, React, UI, and development tooling throughout the observed changes in `package.json`.
*   **Frontend Structure**: The `app/layout.tsx` file consistently manages global CSS imports, custom fonts, metadata, and a client-side loader script, demonstrating a standard Next.js application structure.

## 2:24:47 PM
The `FileManager.jsx` component, located at `c:\Users\91965\Desktop\MikeLegal\CaseTrack-frontend\apps\casetrack-web\src\components\case_status\FileManager.jsx`, was updated on `12/19/2025, 12:42:51 PM`.

This component serves as a robust file management interface for handling case-specific documents. Key functionalities include:

*   **Fetching Documents**: It retrieves a list of previously uploaded documents associated with a specific `management_case_id` from the backend using `axios`, displaying them in a `FileManagerGrid`.
*   **File Uploads**:
    *   Supports uploading individual files and entire directories using Ant Design's `Upload` component.
    *   Implements a multi-step upload process:
        1.  Obtains a pre-signed S3 URL and necessary fields from the backend (`/upload_documents/?operation=S3_SIGNED_URL`).
        2.  Directly uploads the file to AWS S3 using the signed URL and `FormData`.
        3.  After successful S3 upload, sends a confirmation to the backend (`/upload_documents/` with `action: "ADD"`) to register the document in the application's database.
    *   **Real-time Progress Tracking**: Utilizes `onUploadProgress` to update the `uploadStatus` state, providing detailed progress percentage and status (`Uploading`, `Completed`, `Failed`) for each file within an `UploadProgressBar` modal.
    *   **Upload Cancellation**: Each file upload is managed with an `AbortController`, allowing users to cancel ongoing uploads.
    *   **Re-upload Functionality**: Users can re-attempt failed file uploads.
*   **Bulk Download**: Provides an option to download all files associated with a case as a single archive, using a `downloadStreamingFile` utility.
*   **State Management**: It extensively uses `useState` for managing file data, loading states (`loaderType` for fetch, upload, download), upload progress, and modal visibility. `useRef` is used to store references to selected files and `AbortController` instances for cancellation.
*   **Authorization & Error Handling**: All API interactions are authorized with a `Bearer` token obtained via `getValidAccessToken()` and include centralized error handling using `handleAxiosError`.
*   **User Experience**: Features include a `Loader2` for loading states, disabling buttons based on `useOnlineStatus` for network connectivity, and `trackWeb` for analytics on button clicks.
*   **File Type Restrictions**: Uploads are restricted to common document and image formats (e.g., `.doc`, `.pdf`, `.png`, `.jpg`, `.zip`).

**Patterns and Recurring Elements**:
*   Consistent use of `axios` for all backend interactions.
*   `getValidAccessToken()` is a recurring utility for authorization headers.
*   `handleAxiosError` is used across multiple asynchronous operations for error management.
*   Multiple loading states (`loaderType`) are managed to provide granular user feedback.
*   The component relies heavily on Ant Design components (`Button`, `Upload`, `message`) for UI elements and notifications.
*   The pattern of client-side S3 direct upload using pre-signed URLs is central to the file upload mechanism.